<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Delegate List</title>
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --pink:         #e83a8d;
    --pink-dark:    #b82d6e;
    --pink-bg:      #fdf0f7;
    --pink-border:  #f0b8d8;
    --yellow:       #eabe35;
    --yellow-dark:  #c49d1c;
    --yellow-bg:    #fdf8e7;
    --yellow-border:#f0dc90;
    --navy:         #0D1B2A;
    --white:        #FFFFFF;
    --off-white:    #F7F6F4;
    --body-text:    #2A2A2A;
    --muted:        #555555;
    --border:       #DEDAD4;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--white);
    color: var(--body-text);
    font-family: 'Open Sans', sans-serif;
    font-weight: 400;
    line-height: 1.6;
    font-size: 15px;
    padding: 0;
    margin: 0;
  }

  /* ===== WRAPPER ===== */
  .delegate-wrap {
    max-width: 960px;
    margin: 0 auto;
    padding: 32px 24px 48px;
  }

  /* ===== HEADER ===== */
  .dl-header {
    margin-bottom: 28px;
  }

  .dl-header h1 {
    font-family: 'Open Sans', sans-serif;
    font-size: 26px;
    font-weight: 700;
    color: var(--navy);
    margin-bottom: 6px;
  }

  .dl-header p {
    color: var(--muted);
    font-size: 14px;
    margin: 0;
  }

  .dl-header .delegate-count {
    display: inline-block;
    background: var(--pink);
    color: #fff;
    font-size: 12px;
    font-weight: 700;
    padding: 2px 10px;
    border-radius: 12px;
    margin-left: 8px;
    vertical-align: middle;
    letter-spacing: 0.5px;
  }

  /* ===== CONTROLS BAR ===== */
  .controls-bar {
    display: flex;
    gap: 12px;
    margin-bottom: 20px;
    flex-wrap: wrap;
    align-items: stretch;
  }

  .search-box {
    flex: 1;
    min-width: 220px;
    position: relative;
  }

  .search-box input {
    width: 100%;
    padding: 11px 16px 11px 42px;
    border: 2px solid var(--border);
    border-radius: 6px;
    font-family: 'Open Sans', sans-serif;
    font-size: 14px;
    color: var(--body-text);
    background: var(--white);
    transition: border-color 0.2s;
    outline: none;
  }

  .search-box input:focus {
    border-color: var(--pink);
  }

  .search-box input::placeholder {
    color: #aaa;
  }

  .search-box::before {
    content: '';
    position: absolute;
    left: 14px;
    top: 50%;
    transform: translateY(-50%);
    width: 16px;
    height: 16px;
    background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23999' stroke-width='2'%3E%3Ccircle cx='11' cy='11' r='8'/%3E%3Cline x1='21' y1='21' x2='16.65' y2='16.65'/%3E%3C/svg%3E") no-repeat center;
    background-size: contain;
    pointer-events: none;
  }

  .filter-select {
    min-width: 200px;
  }

  .filter-select select {
    width: 100%;
    height: 100%;
    padding: 11px 36px 11px 14px;
    border: 2px solid var(--border);
    border-radius: 6px;
    font-family: 'Open Sans', sans-serif;
    font-size: 14px;
    color: var(--body-text);
    background: var(--white);
    appearance: none;
    -webkit-appearance: none;
    cursor: pointer;
    outline: none;
    transition: border-color 0.2s;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' fill='none'%3E%3Cpath d='M1 1.5L6 6.5L11 1.5' stroke='%23999' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 14px center;
  }

  .filter-select select:focus {
    border-color: var(--pink);
  }

  .clear-btn {
    padding: 11px 18px;
    border: 2px solid var(--border);
    border-radius: 6px;
    background: var(--off-white);
    font-family: 'Open Sans', sans-serif;
    font-size: 13px;
    font-weight: 600;
    color: var(--muted);
    cursor: pointer;
    transition: all 0.2s;
    white-space: nowrap;
  }

  .clear-btn:hover {
    border-color: var(--pink);
    color: var(--pink);
    background: var(--pink-bg);
  }

  /* ===== TABLE ===== */
  .table-container {
    border: 1px solid var(--border);
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 12px rgba(0,0,0,0.04);
  }

  table {
    width: 100%;
    border-collapse: collapse;
  }

  thead th {
    background: var(--navy);
    color: var(--yellow);
    font-weight: 700;
    font-size: 11px;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    padding: 14px 18px;
    text-align: left;
    font-family: 'Open Sans', sans-serif;
    cursor: pointer;
    user-select: none;
    position: relative;
    white-space: nowrap;
    transition: background 0.15s;
  }

  thead th:hover {
    background: #162a40;
  }

  thead th .sort-arrow {
    display: inline-block;
    margin-left: 6px;
    font-size: 10px;
    opacity: 0.4;
    transition: opacity 0.2s;
  }

  thead th.sort-active .sort-arrow {
    opacity: 1;
    color: var(--pink);
  }

  thead th.sort-active {
    background: #162a40;
  }

  tbody td {
    padding: 13px 18px;
    border-bottom: 1px solid var(--border);
    font-size: 14px;
    color: var(--body-text);
    vertical-align: middle;
  }

  tbody tr:last-child td {
    border-bottom: none;
  }

  tbody tr:nth-child(even) td {
    background: var(--off-white);
  }

  tbody tr:hover td {
    background: var(--pink-bg);
  }

  tbody tr {
    transition: background 0.1s;
  }

  /* Column widths */
  th:nth-child(1), td:nth-child(1) { width: 18%; }
  th:nth-child(2), td:nth-child(2) { width: 18%; }
  th:nth-child(3), td:nth-child(3) { width: 30%; }
  th:nth-child(4), td:nth-child(4) { width: 34%; }

  /* Name styling */
  td:nth-child(1), td:nth-child(2) {
    font-weight: 600;
    color: var(--navy);
  }

  /* ===== NO RESULTS ===== */
  .no-results {
    padding: 48px 24px;
    text-align: center;
    color: var(--muted);
    font-size: 14px;
    display: none;
  }

  .no-results .no-results-icon {
    font-size: 32px;
    margin-bottom: 12px;
    opacity: 0.4;
  }

  /* ===== RESULTS COUNT ===== */
  .results-info {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
    font-size: 13px;
    color: var(--muted);
  }

  .results-info .showing-count {
    font-weight: 600;
  }

  /* ===== RESPONSIVE ===== */
  @media (max-width: 700px) {
    .delegate-wrap { padding: 20px 16px 36px; }

    .controls-bar {
      flex-direction: column;
    }

    .filter-select { min-width: 100%; }

    .table-container { border-radius: 6px; }

    thead th {
      padding: 12px 12px;
      font-size: 10px;
      letter-spacing: 1px;
    }

    tbody td {
      padding: 10px 12px;
      font-size: 13px;
    }

    th:nth-child(3), td:nth-child(3) { width: 26%; }
    th:nth-child(4), td:nth-child(4) { width: 30%; }

    .dl-header h1 { font-size: 22px; }
  }

  @media (max-width: 500px) {
    /* Stack into cards on very small screens */
    thead { display: none; }

    tbody tr {
      display: block;
      padding: 14px 16px;
      border-bottom: 1px solid var(--border);
    }

    tbody tr:nth-child(even) {
      background: var(--off-white);
    }

    tbody td {
      display: block;
      padding: 2px 0;
      border: none;
      width: 100% !important;
    }

    tbody td:nth-child(1) {
      font-size: 15px;
      padding-bottom: 0;
    }

    tbody td:nth-child(2) {
      font-size: 15px;
      padding-bottom: 4px;
    }

    tbody td:nth-child(3) {
      font-size: 13px;
      color: var(--muted);
      font-weight: 400;
    }

    tbody td:nth-child(4) {
      font-size: 13px;
      color: var(--pink-dark);
      font-weight: 600;
    }

    tbody td::before {
      display: none;
    }
  }

  /* ===== LETTER NAV ===== */
  .letter-nav {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    margin-bottom: 16px;
  }

  .letter-nav button {
    width: 32px;
    height: 32px;
    border: 1px solid var(--border);
    border-radius: 4px;
    background: var(--white);
    font-family: 'Open Sans', sans-serif;
    font-size: 12px;
    font-weight: 700;
    color: var(--navy);
    cursor: pointer;
    transition: all 0.15s;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .letter-nav button:hover {
    background: var(--pink-bg);
    border-color: var(--pink-border);
    color: var(--pink);
  }

  .letter-nav button.active {
    background: var(--pink);
    border-color: var(--pink);
    color: #fff;
  }

  .letter-nav button.disabled {
    opacity: 0.3;
    cursor: default;
    pointer-events: none;
  }
</style>
</head>
<body>

<div class="delegate-wrap">

  <!-- HEADER -->
  <div class="dl-header">
    <h1>Delegate List <span class="delegate-count" id="totalCount">0</span></h1>
    <p>Browse and search all registered delegates</p>
  </div>

  <!-- CONTROLS -->
  <div class="controls-bar">
    <div class="search-box">
      <input type="text" id="searchInput" placeholder="Search by name, job title, or organisation‚Ä¶">
    </div>
    <div class="filter-select">
      <select id="orgFilter">
        <option value="">All organisations</option>
      </select>
    </div>
    <button class="clear-btn" id="clearBtn">Clear all</button>
  </div>

  <!-- LETTER NAV -->
  <div class="letter-nav" id="letterNav"></div>

  <!-- RESULTS INFO -->
  <div class="results-info">
    <span>Showing <span class="showing-count" id="showingCount">0</span> delegates</span>
  </div>

  <!-- TABLE -->
  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th data-col="0">First Name <span class="sort-arrow">‚ñ≤</span></th>
          <th data-col="1">Surname <span class="sort-arrow">‚ñ≤</span></th>
          <th data-col="2">Job Title <span class="sort-arrow">‚ñ≤</span></th>
          <th data-col="3">Organisation <span class="sort-arrow">‚ñ≤</span></th>
        </tr>
      </thead>
      <tbody id="delegateBody">
      </tbody>
    </table>
    <div class="no-results" id="noResults">
      <div class="no-results-icon">üîç</div>
      <p>No delegates match your search or filter.</p>
    </div>
  </div>

</div>

<script>
// ============================================================
// DELEGATE DATA
// To update this list, replace the array below with new data.
// Each delegate is: [First Name, Surname, Job Title, Organisation]
// ============================================================
const DELEGATES = [
  ["Alice", "Armstrong", "Director of Housing", "Birmingham City Council"],
  ["Ben", "Baker", "Head of Digital Services", "Manchester City Council"],
  ["Catherine", "Clarke", "Chief Executive", "London Borough of Camden"],
  ["David", "Davies", "Portfolio Holder", "Wiltshire Council"],
  ["Eleanor", "Edwards", "Assistant Director", "Kent County Council"],
  ["Fiona", "Foster", "Service Manager", "Leeds City Council"],
  ["George", "Grant", "Head of Planning", "Bristol City Council"],
  ["Hannah", "Hughes", "Programme Director", "Sheffield City Council"],
  ["Ian", "Irving", "Director of Public Health", "Nottingham City Council"],
  ["Jessica", "Jenkins", "Policy Advisor", "Welsh Local Government Association"],
  ["Kevin", "Kelly", "Finance Director", "Durham County Council"],
  ["Laura", "Lewis", "Regeneration Manager", "Liverpool City Council"],
  ["Michael", "Morgan", "Executive Director", "Cornwall Council"],
  ["Natasha", "Norris", "Head of Children's Services", "Surrey County Council"],
  ["Oliver", "Owen", "Climate Change Lead", "Devon County Council"],
  ["Patricia", "Palmer", "Director of Adult Services", "Hampshire County Council"],
  ["Quentin", "Quinn", "Innovation Lead", "Hackney Council"],
  ["Rachel", "Roberts", "Communications Director", "Edinburgh City Council"],
  ["Simon", "Scott", "Head of Partnerships", "Coventry City Council"],
  ["Tanya", "Thompson", "Strategic Director", "Newcastle City Council"],
  ["Usman", "Uddin", "Community Engagement Manager", "Bradford Council"],
  ["Victoria", "Vaughan", "Chief Operating Officer", "Cambridgeshire County Council"],
  ["William", "Watson", "Housing Strategy Lead", "Southwark Council"],
  ["Xena", "Xu", "Data Analytics Manager", "Westminster City Council"],
  ["Yasmin", "Young", "Equalities Officer", "Lambeth Council"],
  ["Zara", "Zhang", "Transport Planner", "Transport for London"],
  ["Andrew", "Atkinson", "Director of Environment", "Oxfordshire County Council"],
  ["Beth", "Burton", "Social Care Lead", "Norfolk County Council"],
  ["Chris", "Campbell", "Head of Revenues", "Glasgow City Council"],
  ["Diana", "Dawson", "Customer Services Manager", "Sunderland City Council"],
];

// ============================================================
// APPLICATION LOGIC ‚Äî no need to edit below this line
// ============================================================

const searchInput = document.getElementById('searchInput');
const orgFilter = document.getElementById('orgFilter');
const clearBtn = document.getElementById('clearBtn');
const delegateBody = document.getElementById('delegateBody');
const noResults = document.getElementById('noResults');
const showingCount = document.getElementById('showingCount');
const totalCount = document.getElementById('totalCount');
const letterNav = document.getElementById('letterNav');

let sortCol = 1; // default sort by surname
let sortAsc = true;
let activeLetter = '';

// Populate organisation filter
function populateOrgFilter() {
  const orgs = [...new Set(DELEGATES.map(d => d[3]))].sort();
  orgs.forEach(org => {
    const opt = document.createElement('option');
    opt.value = org;
    opt.textContent = org;
    orgFilter.appendChild(opt);
  });
}

// Build letter nav
function buildLetterNav() {
  const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
  const usedLetters = new Set(DELEGATES.map(d => d[1].charAt(0).toUpperCase()));

  letters.forEach(letter => {
    const btn = document.createElement('button');
    btn.textContent = letter;
    btn.setAttribute('data-letter', letter);

    if (!usedLetters.has(letter)) {
      btn.classList.add('disabled');
    } else {
      btn.addEventListener('click', () => {
        if (activeLetter === letter) {
          activeLetter = '';
          btn.classList.remove('active');
        } else {
          activeLetter = letter;
          document.querySelectorAll('.letter-nav button').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
        }
        render();
      });
    }

    letterNav.appendChild(btn);
  });
}

// Render table
function render() {
  const query = searchInput.value.toLowerCase().trim();
  const orgVal = orgFilter.value;

  let filtered = DELEGATES.filter(d => {
    // Search filter
    if (query) {
      const combined = d.join(' ').toLowerCase();
      if (!combined.includes(query)) return false;
    }
    // Org filter
    if (orgVal && d[3] !== orgVal) return false;
    // Letter filter
    if (activeLetter && d[1].charAt(0).toUpperCase() !== activeLetter) return false;
    return true;
  });

  // Sort
  filtered.sort((a, b) => {
    const valA = a[sortCol].toLowerCase();
    const valB = b[sortCol].toLowerCase();
    if (valA < valB) return sortAsc ? -1 : 1;
    if (valA > valB) return sortAsc ? 1 : -1;
    return 0;
  });

  // Render rows
  delegateBody.innerHTML = '';
  filtered.forEach(d => {
    const tr = document.createElement('tr');
    d.forEach(val => {
      const td = document.createElement('td');
      // Highlight matching text
      if (query) {
        const idx = val.toLowerCase().indexOf(query);
        if (idx !== -1) {
          td.innerHTML = val.substring(0, idx) +
            '<mark style="background:var(--yellow-bg);color:var(--body-text);padding:1px 2px;border-radius:2px;">' +
            val.substring(idx, idx + query.length) + '</mark>' +
            val.substring(idx + query.length);
        } else {
          td.textContent = val;
        }
      } else {
        td.textContent = val;
      }
      tr.appendChild(td);
    });
    delegateBody.appendChild(tr);
  });

  // Update counts
  showingCount.textContent = filtered.length;
  totalCount.textContent = DELEGATES.length;

  // No results
  noResults.style.display = filtered.length === 0 ? 'block' : 'none';

  // Update sort arrows
  document.querySelectorAll('thead th').forEach((th, i) => {
    th.classList.toggle('sort-active', i === sortCol);
    const arrow = th.querySelector('.sort-arrow');
    if (i === sortCol) {
      arrow.textContent = sortAsc ? '‚ñ≤' : '‚ñº';
    } else {
      arrow.textContent = '‚ñ≤';
    }
  });

  // Tell parent iframe to resize
  notifyParentHeight();
}

// Sort click
document.querySelectorAll('thead th').forEach(th => {
  th.addEventListener('click', () => {
    const col = parseInt(th.getAttribute('data-col'));
    if (sortCol === col) {
      sortAsc = !sortAsc;
    } else {
      sortCol = col;
      sortAsc = true;
    }
    render();
  });
});

// Search
searchInput.addEventListener('input', render);

// Org filter
orgFilter.addEventListener('change', render);

// Clear
clearBtn.addEventListener('click', () => {
  searchInput.value = '';
  orgFilter.value = '';
  activeLetter = '';
  document.querySelectorAll('.letter-nav button').forEach(b => b.classList.remove('active'));
  sortCol = 1;
  sortAsc = true;
  render();
});

// Notify parent iframe of height changes
function notifyParentHeight() {
  requestAnimationFrame(() => {
    const height = document.documentElement.scrollHeight;
    window.parent.postMessage({ type: 'resize', height: height }, '*');
  });
}

// Init
populateOrgFilter();
buildLetterNav();
totalCount.textContent = DELEGATES.length;
render();
</script>

</body>
</html>
